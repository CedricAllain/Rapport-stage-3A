\begin{algorithm}[htpb]
\SetKw{KwDraw}{Draw}

\SetAlgoLined
\KwData{$\lambda(t)$, $T$}

initialize $n = m = 0$, $t_0 = s_0 = 0$, $\Bar{\lambda} = \max_{0 \leq t \leq T} \lambda(t)$\;
\While{$s_m \leq T$}{
   \KwDraw $u \sim \Unif{\intervalleFF{0}{1}}$\;
   $w \leftarrow -\ln u / \Bar{\lambda}$ \atcp{so that $w\sim \Exp{\Bar{\lambda}}$}
   $s_{m+1} \leftarrow s_m + w$\;
   \KwDraw $D \sim \Unif{\intervalleFF{0}{1}}$\;
   \If{$D \leq \lambda(s_{m+1}) / \Bar{\lambda}$}{
      $t_{n+1} \leftarrow s_{m+1}$\;
      $n \leftarrow n+1$\;
      }
   $m \leftarrow m+1$\;
   }
\eIf{$t_n \leq T$}{
   \Return $\braces{t_k}_{k=1,2,\dots,n}$\;
   }{
   \Return $\braces{t_k}_{k=1,2,\dots,n-1}$\;
   }
\caption{\cite{lewis1979simulation}, p.7, Algorithm 1, One-dimensional nonhomogeneous Poisson process}\label{algo:1d_inhomogenous_pp}
\end{algorithm}
